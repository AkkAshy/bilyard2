module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},10550,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(73885),f=a.i(19032);function g(a){return a.toLocaleString("ru-RU")+" сум"}function h(a){return a.toISOString().split("T")[0]}function i(){let a=(0,d.useRouter)(),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)("day"),[o,p]=(0,c.useState)(()=>{let a=new Date;return a.setDate(a.getDate()-30),h(a)}),[q,r]=(0,c.useState)(()=>h(new Date));(0,c.useEffect)(()=>{localStorage.getItem("access_token")?(async()=>{l(!0);try{let a=await f.reports.summary({from:o,to:q,groupBy:m});j(a)}catch(a){console.error("Error fetching report:",a)}finally{l(!1)}})():a.push("/login")},[o,q,m,a]);let s=a=>{let b=f.reports.getExportUrl(a,{from:o,to:q}),c=localStorage.getItem("access_token"),d=localStorage.getItem("tenant_id"),e=document.createElement("form");e.method="GET",e.action=b,e.target="_blank",window.open(`${b}&token=${c}&tenant=${d}`,"_blank")},t=i?.by_period?.length?Math.max(...i.by_period.map(a=>a.revenue||0)):0;return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,b.jsx)(e.default,{}),(0,b.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Отчёты"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{onClick:()=>s("xlsx"),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),(0,b.jsxs)("button",{onClick:()=>s("pdf"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"PDF"]})]})]}),(0,b.jsx)("div",{className:"bg-gray-800 rounded-xl p-4 mb-6",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"От"}),(0,b.jsx)("input",{type:"date",value:o,onChange:a=>p(a.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"До"}),(0,b.jsx)("input",{type:"date",value:q,onChange:a=>r(a.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Группировка"}),(0,b.jsxs)("select",{value:m,onChange:a=>n(a.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,b.jsx)("option",{value:"day",children:"По дням"}),(0,b.jsx)("option",{value:"week",children:"По неделям"}),(0,b.jsx)("option",{value:"month",children:"По месяцам"}),(0,b.jsx)("option",{value:"year",children:"По годам"})]})]})]})}),k?(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)("div",{className:"w-12 h-12 border-4 border-green-500/30 border-t-green-500 rounded-full animate-spin"})}):i?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-green-900/40 to-gray-800 rounded-xl p-5 border border-green-500/30",children:[(0,b.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Выручка"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:g(i.totals.revenue)})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700/50",children:[(0,b.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Сессий"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-white",children:i.totals.sessions})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700/50",children:[(0,b.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Средний чек"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:g(i.totals.avg_check)})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700/50",children:[(0,b.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Ср. длительность"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-blue-400",children:[Math.round(i.totals.avg_duration)," мин"]})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-5 border border-gray-700/50",children:[(0,b.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Загрузка"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-purple-400",children:[i.totals.occupancy_rate,"%"]})]})]}),i.by_period&&i.by_period.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 mb-8 border border-gray-700/50",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Выручка по периодам"}),(0,b.jsx)("div",{className:"flex items-end gap-2 h-48 overflow-x-auto pb-2",children:i.by_period.map((a,c)=>{let d=t>0?(a.revenue||0)/t*100:0;return(0,b.jsxs)("div",{className:"flex flex-col items-center min-w-[60px]",children:[(0,b.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:g(a.revenue||0)}),(0,b.jsx)("div",{className:"w-10 bg-gradient-to-t from-green-600 to-green-400 rounded-t-lg transition-all",style:{height:`${Math.max(d,5)}%`}}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-2 whitespace-nowrap",children:a.period?new Date(a.period).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"}):"—"})]},c)})})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[i.top_assets&&i.top_assets.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700/50",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Топ объектов"}),(0,b.jsx)("div",{className:"space-y-3",children:i.top_assets.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-sm font-bold text-gray-400",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white font-medium",children:a.asset__name}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:a.asset__category__name})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-green-400 font-medium",children:g(a.revenue)}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.sessions," сессий"]})]})]},c))})]}),i.top_categories&&i.top_categories.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700/50",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Топ категорий"}),(0,b.jsx)("div",{className:"space-y-3",children:i.top_categories.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-gray-700 rounded-lg flex items-center justify-center text-sm font-bold text-gray-400",children:c+1}),(0,b.jsx)("div",{className:"text-white font-medium",children:a.asset__category__name})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-green-400 font-medium",children:g(a.revenue)}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.sessions," сессий"]})]})]},c))})]})]})]}):(0,b.jsx)("div",{className:"text-center py-20 text-gray-400",children:"Нет данных для отображения"})]})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__e814a02a._.js.map